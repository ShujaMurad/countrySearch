<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title></title>
    <!-- CSS only -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
    <link rel="stylesheet" href="../css/style.css">
</head>
<style>
    .sidemap .iq-map iframe { border: 0px; width: 100%; }
    .class1 { display: inline; }
    .class11 { display: inline !important; }
    .card-body #map {
        height: 100%;
}
.map-container{
/* overflow:hidden; */
/* padding-bottom:56.25%; */
/* position:relative; */
/* height:0; */
height: 320px;
}
</style>
<body>
    <div class="container-fluid">
        <div class="row justify-content-center">
            <div class="col-sm-3 col-md-3 col-lg-3">
                <div class="row mt-3">
                    <div class="col-lg d-flex justify-content-center">
                        <div class="card  shadow p-0 mb-5 bg-white border-dark rounded coPro">
                            <img src="" srcset="" width="320" class="card-img-center img-fluid" id="cFlag" alt="">
                            <div class="card-body">
                                <hr>
                              <h5 class="text-center text-uppercase text-bold" id="cName"></h5>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="row mt-3 justify-content-center">
                    <div class="col-lg d-flex justify-content-center">
                        <div class="card  shadow p-0 mb-5 bg-white border-dark rounded coPro">
                            <div class="card-body map-container">
                                <div tabindex="800" id="map"></div>
                                <h6 class="text-center text-uppercase text-bold" id="cNamemap"></h6>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-sm-9 col-md-9 col-lg-9">
                <div class="row">
                    <div class="col-lg p-3">
                        <div class="card sidemap">
                            <div class="card-body iq-map">
                                <h5 class="card-title">Country Details</h5>
                                <hr>
                                <ul class="row list-group class1 border-0">
                                    <li class="col-md-12 list-group-item border-0 class1 list-group-item" id="cName1"> </li>
                                    <li class="col-md-12 list-group-item border-0 class1 list-group-item" id="cCap"> </li>
                                    <li class="col-md-12 list-group-item border-0 class1 list-group-item" id="cLang"></li>
                                    <li class="col-md-12 list-group-item border-0 class1 list-group-item" id="cReg"></li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="row mt-5">
                    <div class="col-lg-4 d-flex justify-content-center">
                        <div class="card  shadow p-0 mb-5 bg-white border-dark rounded coPro card-weather">
                            <div class="card-body">
                                
                                <div class="weather-date-location">
                                    <h3>Weather</h3>
                                    <!-- <p class="text-gray"> <span class="weather-date">25 March, 2019</span> <span class="weather-location">Sydney, Australia</span> </p> -->
                                </div>
                                <div class="weather-data d-flex mt-5">
                                    <div class="mr-auto">
                                        <h4 class="display-3">
                                            <div id="openweathermap-widget-24"></div>
                                            <script>
                                            </script>
                                        </h4>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-lg-4 d-flex justify-content-center">
                        <div class="card  shadow p-0 mb-5 bg-white border-dark rounded coPro card-weather">
                            <div class="card-body">
                                <div class="weather-date-location">
                                    <h3> Population </h3>
                                    <p class="text-gray"> <span class="weather-date">as per the data on internet</span>  </p>
                                </div>
                                <div class="weather-data d-flex">
                                    <div class="mr-auto">
                                        <h4 class="display-4" id="cPop"> </h4>
                                        <p>  </p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-lg-4 d-flex justify-content-center">
                        <div class="card  shadow p-0 mb-5 bg-white border-dark rounded coPro card-weather">
                            <div class="card-body">
                                <div class="weather-date-location">
                                    <h3> Currency </h3>
                                    <p class="text-gray"> <span class="weather-date"id="cBref"></span>  </p>
                                </div>
                                <div class="weather-data d-flex">
                                    <div class="mr-auto">
                                        <h4 class="display-6" id="cCurrency"></h4>
                                        <p>  </p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</body>
<!-- JavaScript Bundle with Popper -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p" crossorigin="anonymous"></script>
<script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q" crossorigin="anonymous"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl" crossorigin="anonymous"></script>
<!-- <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mdb-ui-kit/3.10.2/mdb.min.js"></script> -->
<!-- <script src="../js/script.js"></script> -->

<script>
window.onload = (event) => {
    urlString   = window.location.href;
    countryName = urlString.substring(urlString.indexOf('?') + 1);
    // console.log(countryName);
    urlCount    = countryName.replace("%20"," ")
    document.title = "Country - "+urlCount
    fetch("https://restcountries.com/v2/name/"+countryName)
    .then((res) => res.json())
    .then((data) => {
        let name,
        capital,
        region,
        subregion,
        language,
        currencies,
        population,
        domain = ""
        // JSON.stringify(data)
        // console.log(data)
        countries = data;
        countries.forEach((country) => {
        // console.log(country.name)
            name = country.name
            capital = country.capital
            region = country.region
            subregion = country.subregion
            language = country.languages
            currencies = country.currencies
            population = country.population
            domain = country.topLevelDomain
            cSymbol = currencies[0].symbol
            cFlag = domain[0].slice(1);
            cLatlng  =  country.latlng
    });
            //Google maps API initialisation
        var element = document.getElementById("map");

        var map = new google.maps.Map(element, {
        center: new google.maps.LatLng(cLatlng[0],cLatlng[1]),
        zoom: 3,
        mapTypeId: "OSM",
        mapTypeControl: false,
        streetViewControl: false
        });

        //Define OSM map type pointing at the OpenStreetMap tile server
        map.mapTypes.set("OSM", new google.maps.ImageMapType({
        getTileUrl: function(coord, zoom) {
            return "https://tile.openstreetmap.org/" + zoom + "/" + coord.x + "/" + coord.y + ".png";
        },
        tileSize: new google.maps.Size(256, 256),
        name: "OpenStreetMap",
        maxZoom: 18
        }));

        element.addEventListener('click', (e) => {
            console.log(name)
            let cUrl = name.replace("+"," ")
            window.open('https://www.google.com/maps/place/'+cUrl, '_blank');
        })
    // getElementById('cFlag').
    document.getElementById('cFlag').src = 'https://flagcdn.com/w320/'+cFlag+'.png'
    document.getElementById('cFlag').srcset = 'https://flagcdn.com/w640/'+cFlag+'.png 2x'
    document.getElementById('cFlag').alt = name
    document.getElementById('cName').innerHTML = name
    document.getElementById('cName1').innerHTML = "<strong>Country Name</strong>: "+name
    document.getElementById('cCap').innerHTML = "<strong>Country Capital</strong>: "+capital
    document.getElementById('cLang').innerHTML = "<strong>Language Spoken</strong>: "+language[0].name
    document.getElementById('cReg').innerHTML = "<strong>Region</strong>: "+region
    document.getElementById('cNamemap').innerHTML = name + " MAP"
    document.getElementById('cPop').innerHTML = abbreviateNumber(population)
    // document.getElementById('cBref').innerHTML = name
    document.getElementById('cCurrency').innerHTML = currencies[0].name+" "+currencies[0].symbol
    // document.getElementById('cSystem').innerHTML = currencies[0].symbol
    function abbreviateNumber(value) {
    var newValue = value;
    if (value >= 1000) {
        var suffixes = ["", "k", "m", "b","t"];
        var suffixNum = Math.floor( (""+value).length/3 );
        var shortValue = '';
        for (var precision = 2; precision >= 1; precision--) {
            shortValue = parseFloat( (suffixNum != 0 ? (value / Math.pow(1000,suffixNum) ) : value).toPrecision(precision));
            var dotLessShortValue = (shortValue + '').replace(/[^a-zA-Z 0-9]+/g,'');
            if (dotLessShortValue.length <= 2) { break; }
        }
        if (shortValue % 1 != 0)  shortValue = shortValue.toFixed(1);
        newValue = shortValue+suffixes[suffixNum];
    }
    return newValue;
}
    // console.log(cLatlng)
    fetch("https://api.openweathermap.org/data/2.5/weather?lat=" +cLatlng[0] + "&lon=" +cLatlng[1] + "&appid=fa18fba0f40d6ac90009da13bef39d7f")
    .then((res) => res.json())
    .then((data) => {
        console.log(data.id)
        window.myWidgetParam ? window.myWidgetParam : window.myWidgetParam = [];
        window.myWidgetParam.push({id: 24,cityid: data.id,appid: '09b8a96225a26a1a86c183c15b4eaeac',units: 'metric',containerid: 'openweathermap-widget-24',  });
        (function() {
            var script = document.createElement('script');script.async = true;script.charset = "utf-8";

            script.src = "//openweathermap.org/themes/openweathermap/assets/vendor/owm/js/weather-widget-generator.js";
            var s = document.getElementsByTagName('script')[0];s.parentNode.insertBefore(script, s);  
        })();
    })
    // console.log(cLatlng[0],name,capital,region,subregion,language[0].name,currencies[0].name,currencies[0].symbol,population,domain[0])
  });

};
    </script>
    <script src="https://maps.googleapis.com/maps/api/js?key=Aliza&callback=myMap"></script>
</html>
